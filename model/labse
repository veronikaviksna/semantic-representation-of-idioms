# -*- coding: utf-8 -*-


Automatically generated by Colab.

Original file is located at Colab

from typing import List
import numpy as np
from sentence_transformers import SentenceTransformer


class LaBSEEncoder:
    """
    Wrapper around the LaBSE sentence embedding model.
    """

    def __init__(self, device: str | None = None):
        """
        Initialize LaBSE model.

        Parameters
        ----------
        device : str, optional
            Device to run the model on ('cpu' or 'cuda').
            If None, SentenceTransformer selects automatically.
        """
        self.model = SentenceTransformer(
            "sentence-transformers/LaBSE",
            device=device
        )

    def encode(
        self,
        sentences: List[str],
        batch_size: int = 32,
        normalize: bool = True
    ) -> np.ndarray:
        """
        Encode a list of sentences into embeddings.

        Parameters
        ----------
        sentences : list of str
            Input sentences.
        batch_size : int
            Batch size for encoding.
        normalize : bool
            Whether to L2-normalize embeddings.

        Returns
        -------
        embeddings : np.ndarray
            Shape (n_sentences, embedding_dim)
        """
        embeddings = self.model.encode(
            sentences,
            batch_size=batch_size,
            show_progress_bar=True,
            convert_to_numpy=True,
            normalize_embeddings=normalize,
        )
        return embeddings
